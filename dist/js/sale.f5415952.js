(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["sale"],{"2a18":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order"},[a("div",{staticClass:"table_title"},[e.show?a("el-button",{attrs:{type:"primary",icon:"el-icon-d-arrow-left",size:"mini"},on:{click:e.getBack}},[e._v("返回")]):e._e(),e.show?e._e():a("span"),a("div",{staticClass:"search_wrap"},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入订单编号",size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.order_sn,callback:function(t){e.order_sn=t},expression:"order_sn"}}),e._v("申请时间：\n      "),a("el-date-picker",{staticStyle:{margin:"0 10px"},attrs:{"value-format":"timestamp",size:"mini",type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"起始时间","end-placeholder":"终止时间","picker-options":e.pickerOptions},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.search}},[e._v("搜索")])],1)],1),a("div",{staticClass:"content",staticStyle:{width:"100%"}},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.tabClick},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.tabList,function(t,s){return a("el-tab-pane",{key:s,attrs:{label:t.label,name:t.name}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:Math.random(),attrs:{data:e.dataList.list,stripe:"",border:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"expand_wrap"},[a("p",[e._v("申请时间："+e._s(t.row.create_times))]),a("p",[e._v("售后原因："+e._s(t.row.reason))]),a("p",[e._v("售后说明："+e._s(t.row.explain))]),a("p",[e._v("售后状态："+e._s(t.row.text))]),a("p",[e._v("处理人："+e._s(t.row.handler))]),t.row.certificate.length?a("p",e._l(t.row.certificate,function(t,s){return a("span",{key:s,staticClass:"certificate-img"},[a("img",{attrs:{src:t},on:{click:function(a){return e.viewImg(t)}}})])}),0):a("p",[e._v("凭证：无")])])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"order_sn",label:"订单编号",align:"center"}}),a("el-table-column",{attrs:{prop:"username",label:"申请人",align:"center"}}),a("el-table-column",{attrs:{prop:"amount",label:"售后金额(元)",align:"center"}}),a("el-table-column",{attrs:{prop:"pay_amount",label:"支付金额(元)",align:"center"}}),a("el-table-column",{attrs:{prop:"card_num",label:"退还卡卷量",align:"center"}}),a("el-table-column",{attrs:{prop:"outlet",label:"抵扣金额(元)",align:"center"}}),a("el-table-column",{attrs:{label:"售后商品",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-view"},on:{click:function(a){return e.viewGoods(t.row.goods)}}},[e._v("查看")])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"types",label:"售后类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:"1"==t.row.types?"color:red":""},[e._v(e._s("1"==t.row.types?"退款":"退货退款"))])]}}],null,!0)}),"3"==e.status?a("el-table-column",{attrs:{prop:"status",label:"退货物流",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==t.row.types&&"6"==t.row.status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.openExpressDialog(t.row)}}},[e._v("查看物流")]):a("span",{style:"2"!=t.row.types?"":"6"!=t.row.status?"color:red":""},[e._v(e._s("2"!=t.row.types?"不存在物流信息":"6"!=t.row.status?"未填写退货物流":""))])]}}],null,!0)}):e._e(),"5"!=e.status?a("el-table-column",{attrs:{prop:"create_times",label:"申请时间",align:"center"}}):e._e(),"5"==e.status?a("el-table-column",{attrs:{prop:"times",label:"退款时间",align:"center"}}):e._e(),"2"==e.status||"3"==e.status?a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==e.status?a("el-button",{staticClass:"mini-button",attrs:{type:"success",size:"mini",icon:"iconfont daichuli"},on:{click:function(a){return e.openHandleDialog(t.row)}}},[e._v("处理")]):e._e(),"3"==e.status?a("el-button",{staticClass:"mini-button",attrs:{type:"success",size:"mini",icon:"iconfont daichuli"},on:{click:function(a){return e.applyRefund(t.row)}}},[e._v("申请退款")]):e._e()]}}],null,!0)}):e._e()],1)],1)}),1),a("el-pagination",{attrs:{background:"","current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.dataList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"订单商品",visible:e.openOrderGoodsDialog},on:{"update:visible":function(t){e.openOrderGoodsDialog=t}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.order_goods,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"title",label:"商品名称",align:"center"}}),a("el-table-column",{attrs:{prop:"",label:"商品图片",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticClass:"avatar",attrs:{src:e.row.pics}})]}}])}),a("el-table-column",{attrs:{prop:"attr",label:"商品属性",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.goods_attr.attr_val))])]}}])})],1)],1),a("el-dialog",{attrs:{title:"退货物流信息",visible:e.expressDialog},on:{"update:visible":function(t){e.expressDialog=t}}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"物流公司"}},[a("el-input",{attrs:{readonly:""},model:{value:e.express_company,callback:function(t){e.express_company=t},expression:"express_company"}})],1),a("el-form-item",{attrs:{label:"物流单号"}},[a("el-input",{attrs:{readonly:""},model:{value:e.express_num,callback:function(t){e.express_num=t},expression:"express_num"}})],1),a("el-form-item",{attrs:{label:"发起时间"}},[a("el-input",{attrs:{readonly:""},model:{value:e.express_time,callback:function(t){e.express_time=t},expression:"express_time"}})],1)],1)],1),a("el-dialog",{attrs:{title:"处理售后",visible:e.handleDialog},on:{"update:visible":function(t){e.handleDialog=t},close:function(t){e.form.status=""}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"售后处理"}},[a("el-radio-group",{on:{change:e.clear},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:3}},[e._v("同意")]),a("el-radio",{attrs:{label:4}},[e._v("拒绝")])],1)],1),"3"==e.form.status&&"2"==e.sale_status?a("el-form-item",{attrs:{label:"退货地址"}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入退货地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}},e._l(e.address,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e(),"3"==e.form.status&&"2"==e.sale_status?a("el-form-item",{attrs:{label:"联系方式"}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入联系方式"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}},e._l(e.phone,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e(),"4"==e.form.status?a("el-form-item",{attrs:{label:"拒绝原因"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.result,callback:function(t){e.$set(e.form,"result",t)},expression:"form.result"}})],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handle()}}},[e._v("确定")]),a("el-button",{on:{click:function(t){e.handleDialog=!1}}},[e._v("取消")])],1)],1),a("el-dialog",{attrs:{visible:e.viewImgDialog},on:{"update:visible":function(t){e.viewImgDialog=t}}},[a("div",{staticClass:"view-img"},[a("img",{attrs:{src:e.image}})])])],1)},l=[],n=(a("7f7f"),{data:function(){return{loading:!1,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},tabList:[{label:"等待处理",name:"2"},{label:"申请退款",name:"3"},{label:"申请售后",name:"0"},{label:"商户申请退款",name:"1"},{label:"平台拒绝",name:"4"},{label:"等待退款",name:"7"},{label:"完成售后",name:"5"}],date:[],status:"2",dataList:[],page:1,limit:10,order_sn:"",show:!1,viewImgDialog:!1,handleDialog:!1,image:"",sale_status:"1",form:{id:"",status:"",result:"",address:"",phone:""},phone:[],address:[],uid:JSON.parse(localStorage.getItem("userinfo")).id,express_company:"",express_num:"",express_time:"",expressDialog:!1,order_goods:[],openOrderGoodsDialog:!1}},mounted:function(){},methods:{viewImg:function(e){this.viewImgDialog=!0,this.image=e},handleSizeChange:function(e){this.limit=e,this.getDataList()},handleCurrentChange:function(e){this.page=e,this.getDataList()},viewGoods:function(e){this.openOrderGoodsDialog=!0,this.order_goods=e},getBack:function(){var e=this;this.loading=!0,this.$api.getSaleList({page:1,limit:10,status:"2"}).then(function(t){e.dataList=t.data||[],e.loading=!1,e.show=!1,e.status="2",e.date=[],e.order_sn=""})},getDataList:function(){var e=this;this.loading=!0,this.$api.getSaleList({page:this.page,limit:this.limit,status:this.status,times:this.date,order_sn:this.order_sn}).then(function(t){e.dataList=t.data||[],e.loading=!1})},getAddress:function(){var e=this;this.$api.getAddress().then(function(t){e.phone=t.data.phone||[],e.address=t.data.address||[]})},tabClick:function(e){this.status=e.name,this.page=1,this.getDataList()},search:function(){this.show=!0,this.page=1,this.getDataList()},openHandleDialog:function(e){this.form.id=e.id,this.sale_status=e.types,this.clear(),this.handleDialog=!0,this.getAddress()},clear:function(){this.form.result="",this.form.address="",this.form.phone="",console.log(this.form)},handle:function(){var e=this;this.$api.suProcess(this.form).then(function(t){e.$message[t.code?"warning":"success"](t.data.message),e.handleDialog=!1,e.getDataList()})},openExpressDialog:function(e){this.express_company=e.company,this.express_num=e.express_num,this.express_time=e.express_time,this.expressDialog=!0},applyRefund:function(e){var t=this;this.form.id=e.id,this.form.status="7","2"==e.types&&"6"!=e.status?this.$confirm("该用户未填写退货物流信息，确定申请退款吗？").then(function(e){t.handle()}):this.handle()}},created:function(){this.getDataList()}}),i=n,o=(a("af8b"),a("2877")),r=Object(o["a"])(i,s,l,!1,null,"3263fcd4",null);t["default"]=r.exports},ae95:function(e,t,a){},af8b:function(e,t,a){"use strict";var s=a("ae95"),l=a.n(s);l.a}}]);
//# sourceMappingURL=sale.f5415952.js.map